version: '{build}'
image:
  - Visual Studio 2017
  - Ubuntu1804
configuration:
  - Debug
  - Release
build_script:
  - cmd: build.cmd $env:CONFIGURATION
  - sh: chmod +x build.sh
  - sh: chmod +x ./eng/build.sh
  - sh: ./build.sh $CONFIGURATION
test_script:
  - ps: if ($LastExitCode -ne 0) { $host.SetShouldExit($LastExitCode) }
  - ps: |
      if ($env:APPVEYOR_BUILD_WORKER_IMAGE -eq "Ubuntu1804" -and $env:CONFIGURATION -eq "Release") {
        curl -s https://codecov.io/bash > codecov
        chmod +x codecov
        ./codecov -f ./test/coverlet.core.tests/coverage.opencover.xml
      }
artifacts:
- path: src\coverlet.msbuild.tasks\bin\Release\*.nupkg
- path: build\Release\*.nupkg
